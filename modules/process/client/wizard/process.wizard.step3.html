<h2>Add Transformations</h2>
<div class="row">
    <div class="col-md-6">
        <p><strong>New Dataset: </strong>{{ ProcessStep3.selecteddataset.title }}</p>
        <div class="loader text-center" ng-show="ProcessStep3.showLoader">
            <i class="spinner"></i>
        </div>
        <div class="overflow: auto;" ng-show="!ProcessStep3.showLoader">
            <div style="overflow: auto;">
                <div class="form-group row">
                    <div class="col-md-3">
                        <label>Key Field:</label>
                    </div>
                    <div class="col-md-5">
                        <select name="keyfield" class="form-control" ng-model="ProcessStep3.keyfield" ng-options="column as column for column in ProcessStep3.currentdataset.columns" required>
                        </select>
                    </div>
                </div>
                <table class="table table-striped table-bordered">
                    <thead>
                    <th ng-repeat="column in ProcessStep3.currentdataset.columns">Exclude? <input type="checkbox" ng-model="ProcessStep3.excludedcolumns[column]" /></th>
                    </thead>
                    <thead>
                        <th ng-repeat="column in ProcessStep3.currentdataset.columns" ng-bind="column" ng-class="{ 'exclude' : ProcessStep3.excludedcolumns[column] }"></th>
                    </thead>
                    <thead>
                        <th ng-repeat="column in ProcessStep3.currentdataset.renamedcolumns" ng-class="{ 'exclude' : ProcessStep3.excludedcolumns[column] }"><input type="text" class="form-control" ng-model="column" ng-disabled="ProcessStep3.excludedcolumns[column]" /></th>
                    </thead>
                    <tbody>
                        <tr ng-repeat="row in ProcessStep3.currentdataset.rows">
                            <td ng-repeat="column in ProcessStep3.currentdataset.columns" ng-bind="row[column]"  ng-class="{ 'exclude' : ProcessStep3.excludedcolumns[column] }"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <ul class="nav nav-tabs" data-tabs="tabs">
            <li data-ng-repeat="item in ProcessStep3.tabs" ng-class="{'active' : item == ProcessStep3.activeTab }" ng-click="ProcessStep3.changeTab(item)">
                <a data-ng-bind="item" data-toggle="tab" href=""></a>
            </li>
        </ul>
        <div class="tab-content">
            <div role="tabpanel" data-ng-repeat="item in ProcessStep3.tabs" ng-class="{'active' : item == ProcessStep3.activeTab }" class="tab-pane">
                <div ng-if="item == 'Old Model Dataset'">
                    <div class="loader text-center" ng-show="ProcessStep3.showModelLoader">
                        <i class="spinner"></i>
                    </div>
                    <div ng-show="!ProcessStep3.showModelLoader">
                        <div class="row">
                            <div class="col-md-12"><p><strong>Model: {{ ProcessStep3.selectedmodel.title }}</strong></p></div>
                        </div>
                        <div class="row">
                            <div class="col-md-6"><p>Type: {{ ProcessStep3.selectedmodel.type }}</p></div>
                            <div class="col-md-6"><p>Equation: {{ ProcessStep3.selectedmodel.equation }}</p></div>
                        </div>
                        <div class="clearfix" style="overflow: auto;width: 100%;">
                            <div class="form-group row">
                                <div class="col-md-3">
                                    <label>Key Field:</label>
                                </div>
                                <div class="col-md-5">
                                    <select name="keyfield" class="form-control" ng-model="ProcessStep3.modelkeyfield" ng-options="column as column for column in ProcessStep3.currentmodeldataset.columns" required>
                                    </select>
                                </div>
                            </div>
                            <div class="pull-right">
                                <a href="" ng-click="ProcessStep3.selectModelColumnsAll()">Select All</a>
                                <a href="" ng-click="ProcessStep3.unselectModelColumnsAll()">Unselect All</a>
                            </div>
                            <table class="table table-striped table-bordered">
                                <thead>
                                <th ng-repeat="column in ProcessStep3.currentmodeldataset.columns">Include in Transform? <input type="checkbox" name="selectedcolumn" ng-model="ProcessStep3.selectedmodelcolumns[column]" /></th>
                                </thead>
                                <thead>
                                    <th ng-repeat="column in ProcessStep3.currentmodeldataset.columns" ng-bind="column"></th>
                                </thead>
                                <thead>
                                <th ng-repeat="column in ProcessStep3.currentmodeldataset.renamedcolumns"><input type="text" ng-model="column" class="form-control" /></th>
                                </thead>
                                <tbody>
                                <tr ng-repeat="row in ProcessStep3.currentmodeldataset.rows">
                                    <td ng-repeat="column in ProcessStep3.currentmodeldataset.columns" ng-bind="row[column]"></td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="text-center">
            <button class="btn btn-primary">Add Step to Transforms</button>
        </div>
    </div>
</div>
<br/><br/><br/><br/>
<div>
    <button ng-click="ProcessWizard.goBack()" class="btn btn-seconday pull-left">Back - Choose Data</button>
    <button ng-click="ProcessWizard.changeState('lab.process2.step4')" class="btn btn-primary pull-right">Next - Add a model to your workflow</button>
</div>
